2025-04-30 17:26:32.583313: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-30 17:26:32.595026: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-30 17:26:33.184693: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-30 17:26:33.194739: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746048393.209301 2279171 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746048393.213714 2279171 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-30 17:26:34.781156: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Analyis of db2151 in tax = genus-------------------------------------------------------------------------------------------
ibd
nonIBD    804
UC         22
CD         10
Name: count, dtype: int64
Best C: 9.999999999999999e-05
Best C: 9.999999999999999e-05
The shape of the original dataset is  (836, 346)
The shape of the SelectMicro dataset is  (836, 31)
The shape of the SelectMicro_strict dataset is  (836, 27)
5 fold cross validation using Random forest model -----------------------------------------
Analysis for AllFeatures
The combined confusion matrix
[[804   0   0]
 [ 10   0   0]
 [ 12   0  10]]
Mean Accuracy: 0.974 (0.005),Mean F1: 0.965 (0.007),Mean MCC: nan (nan),  Mean AUC: 0.904 (0.052)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_AllFeatures_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_AllFeatures_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_AllFeatures__ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_AllFeatures_SHAP_class2.png
Analysis for SelectMicro_strict
The combined confusion matrix
[[798   3   3]
 [ 10   0   0]
 [ 12   0  10]]
Mean Accuracy: 0.967 (0.003),Mean F1: 0.960 (0.005),Mean MCC: nan (nan),  Mean AUC: 0.958 (0.016)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_SelectMicro_strict_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_SelectMicro_strict_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_SelectMicro_strict__ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_SelectMicro_strict_SHAP_class2.png
Analysis for SelectMicro
The combined confusion matrix
[[801   1   2]
 [ 10   0   0]
 [ 13   0   9]]
Mean Accuracy: 0.969 (0.004),Mean F1: 0.961 (0.005),Mean MCC: nan (nan),  Mean AUC: 0.951 (0.009)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_SelectMicro_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_SelectMicro_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_SelectMicro__ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_RF_SelectMicro_SHAP_class2.png
5 fold cross validation using XGBoost model -----------------------------------------
Analysis for AllFeatures
The combined confusion matrix
[[799   1   4]
 [  7   1   2]
 [  8   0  14]]
Mean Accuracy: 0.974 (0.006),Mean F1: 0.968 (0.006),Mean MCC: nan (nan),  Mean AUC: 0.961 (0.029)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_AllFeatures_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_AllFeatures_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_AllFeatures_ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_AllFeatures_SHAP_class2.png
Analysis for SelectMicro_strict
The combined confusion matrix
[[791   5   8]
 [  8   2   0]
 [  7   0  15]]
Mean Accuracy: 0.967 (0.013),Mean F1: 0.964 (0.014),Mean MCC: nan (nan),  Mean AUC: 0.954 (0.024)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_SelectMicro_strict_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_SelectMicro_strict_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_SelectMicro_strict_ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_SelectMicro_strict_SHAP_class2.png
Analysis for SelectMicro
The combined confusion matrix
[[793   4   7]
 [  8   2   0]
 [  6   0  16]]
Mean Accuracy: 0.970 (0.011),Mean F1: 0.967 (0.012),Mean MCC: nan (nan),  Mean AUC: 0.965 (0.019)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_SelectMicro_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_SelectMicro_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_SelectMicro_ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_genus_XG_SelectMicro_SHAP_class2.png
Analyis of db2151 in tax = species-------------------------------------------------------------------------------------------
ibd
nonIBD    804
UC         22
CD         10
Name: count, dtype: int64
Best C: 9.999999999999999e-05
Best C: 2.782559402207126
The shape of the original dataset is  (836, 432)
The shape of the SelectMicro dataset is  (836, 36)
The shape of the SelectMicro_strict dataset is  (836, 33)
5 fold cross validation using Random forest model -----------------------------------------
Analysis for AllFeatures
The combined confusion matrix
[[804   0   0]
 [  9   1   0]
 [  8   0  14]]
Mean Accuracy: 0.980 (0.006),Mean F1: 0.973 (0.008),Mean MCC: nan (nan),  Mean AUC: 0.939 (0.040)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_AllFeatures_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_AllFeatures_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_AllFeatures__ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_AllFeatures_SHAP_class2.png
Analysis for SelectMicro_strict
The combined confusion matrix
[[801   2   1]
 [  9   1   0]
 [  8   0  14]]
Mean Accuracy: 0.976 (0.005),Mean F1: 0.970 (0.008),Mean MCC: nan (nan),  Mean AUC: 0.969 (0.018)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_SelectMicro_strict_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_SelectMicro_strict_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_SelectMicro_strict__ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_SelectMicro_strict_SHAP_class2.png
Analysis for SelectMicro
The combined confusion matrix
[[802   1   1]
 [  8   2   0]
 [  8   0  14]]
Mean Accuracy: 0.978 (0.009),Mean F1: 0.973 (0.012),Mean MCC: nan (nan),  Mean AUC: 0.966 (0.020)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_SelectMicro_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_SelectMicro_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_SelectMicro__ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_RF_SelectMicro_SHAP_class2.png
5 fold cross validation using XGBoost model -----------------------------------------
Analysis for AllFeatures
The combined confusion matrix
[[800   2   2]
 [  8   2   0]
 [  9   0  13]]
Mean Accuracy: 0.975 (0.006),Mean F1: 0.969 (0.008),Mean MCC: nan (nan),  Mean AUC: 0.956 (0.031)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_AllFeatures_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_AllFeatures_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_AllFeatures_ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_AllFeatures_SHAP_class2.png
Analysis for SelectMicro_strict
The combined confusion matrix
[[795   5   4]
 [  7   2   1]
 [  8   0  14]]
Mean Accuracy: 0.970 (0.004),Mean F1: 0.966 (0.007),Mean MCC: nan (nan),  Mean AUC: 0.966 (0.025)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_SelectMicro_strict_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_SelectMicro_strict_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_SelectMicro_strict_ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_SelectMicro_strict_SHAP_class2.png
Analysis for SelectMicro
The combined confusion matrix
[[795   5   4]
 [  7   2   1]
 [  8   0  14]]
Mean Accuracy: 0.970 (0.004),Mean F1: 0.966 (0.007),Mean MCC: nan (nan),  Mean AUC: 0.967 (0.024)
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_SelectMicro_ROC_class1.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_SelectMicro_SHAP_class1.png
Saved ROC curve to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_SelectMicro_ROC_class2.png
Saved SHAP to: /lustre/isaac24/scratch/mhe8/SelectMicro_24/Analysis/Qitta/results/analysis_3/plots/higher/db2151_species_XG_SelectMicro_SHAP_class2.png
